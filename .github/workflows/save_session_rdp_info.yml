name: üíæ Save RDP Session Data

on:
  workflow_dispatch:
    inputs:
      rdp_host:
        description: 'üîó RDP Host (ex: 2.tcp.ngrok.io:13427)'
        required: true
        type: string
      rdp_username:
        description: 'üë§ RDP Username'
        required: true
        type: string
      rdp_password:
        description: 'üîë RDP Password'
        required: true
        type: string
      session_name:
        description: 'üìÅ Session Name (pour le dossier)'
        required: true
        type: string
        default: 'rdp-session'

jobs:
  save-rdp-data:
    runs-on: ubuntu-latest
    
    steps:
    - name: üìã Step 1 - Checkout Repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.REPO_TOKEN }}
      
    - name: üîç Step 2 - Display Connection Info
      run: |
        echo "=============================================="
        echo "üéØ INFORMATIONS DE CONNEXION RDP"
        echo "=============================================="
        echo "üîó Host: ${{ github.event.inputs.rdp_host }}"
        echo "üë§ Username: ${{ github.event.inputs.rdp_username }}"
        echo "üìÅ Session: ${{ github.event.inputs.session_name }}"
        echo "üìÖ Date: $(date)"
        echo "=============================================="
    
    - name: üîß Step 3 - Install System Dependencies
      run: |
        echo "üì¶ Installation des d√©pendances syst√®me..."
        sudo apt-get update -qq
        sudo apt-get install -y xrdp rdesktop sshpass zip unzip curl wget
        sudo apt-get install -y python3 python3-pip
        pip3 install paramiko scp requests
        echo "‚úÖ D√©pendances install√©es avec succ√®s"
    
    - name: üìÅ Step 4 - Create Session Directory Structure
      run: |
        echo "üèóÔ∏è Cr√©ation de la structure de dossiers..."
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}"
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}/files"
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}/system_info"
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}/applications"
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}/logs"
        mkdir -p "./sessions/${{ github.event.inputs.session_name }}/screenshots"
        
        echo "üìù Cr√©ation du fichier d'informations de session..."
        cat > "./sessions/${{ github.event.inputs.session_name }}/session_info.txt" << EOF
        ================================================
        üéØ SESSION RDP INFORMATION
        ================================================
        Session Name: ${{ github.event.inputs.session_name }}
        RDP Host: ${{ github.event.inputs.rdp_host }}
        Username: ${{ github.event.inputs.rdp_username }}
        Date Created: $(date)
        Extraction Status: IN PROGRESS
        ================================================
        EOF
        
        echo "‚úÖ Structure de dossiers cr√©√©e"
        ls -la "./sessions/${{ github.event.inputs.session_name }}/"
    
    - name: üêç Step 5 - Create RDP Data Extraction Script
      run: |
        echo "üî® Cr√©ation du script d'extraction RDP..."
        cat > extract_rdp_data.py << 'EOF'
        import os
        import sys
        import json
        import subprocess
        import time
        from datetime import datetime
        
        def log_step(message):
            timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
            print(f"[{timestamp}] {message}")
        
        def main():
            log_step("üöÄ D√©but de l'extraction RDP")
            
            # Param√®tres de connexion
            rdp_host = sys.argv[1]
            rdp_username = sys.argv[2]
            rdp_password = sys.argv[3]
            session_name = sys.argv[4]
            
            session_dir = f"./sessions/{session_name}"
            
            log_step(f"üì° Connexion √† {rdp_host}")
            log_step(f"üë§ Utilisateur: {rdp_username}")
            log_step(f"üìÅ Session: {session_name}")
            
            # S√©parer host et port
            if ':' in rdp_host:
                host, port = rdp_host.split(':')
            else:
                host = rdp_host
                port = '3389'
            
            log_step(f"üîó Host: {host}, Port: {port}")
            
            # Cr√©er le script de commandes Windows pour extraction
            log_step("üìù Cr√©ation du script d'extraction Windows...")
            
            windows_script = f'''
        @echo off
        echo ================================================
        echo üéØ EXTRACTION DES DONNEES RDP
        echo ================================================
        echo Host: {rdp_host}
        echo User: {rdp_username}
        echo Session: {session_name}
        echo Date: %date% %time%
        echo ================================================
        
        REM Cr√©er le dossier de sauvegarde
        mkdir C:\\rdp_backup 2>nul
        echo üìÅ Dossier de sauvegarde cr√©√©
        
        REM Sauvegarder les dossiers principaux
        echo üñ•Ô∏è Sauvegarde du Desktop...
        xcopy "%USERPROFILE%\\Desktop" "C:\\rdp_backup\\Desktop" /E /H /Y /I 2>nul
        echo ‚úÖ Desktop sauvegard√©
        
        echo üìÑ Sauvegarde des Documents...
        xcopy "%USERPROFILE%\\Documents" "C:\\rdp_backup\\Documents" /E /H /Y /I 2>nul
        echo ‚úÖ Documents sauvegard√©s
        
        echo üì• Sauvegarde des Downloads...
        xcopy "%USERPROFILE%\\Downloads" "C:\\rdp_backup\\Downloads" /E /H /Y /I 2>nul
        echo ‚úÖ Downloads sauvegard√©s
        
        echo üñºÔ∏è Sauvegarde des Pictures...
        xcopy "%USERPROFILE%\\Pictures" "C:\\rdp_backup\\Pictures" /E /H /Y /I 2>nul
        echo ‚úÖ Pictures sauvegard√©es
        
        echo üéµ Sauvegarde des Music...
        xcopy "%USERPROFILE%\\Music" "C:\\rdp_backup\\Music" /E /H /Y /I 2>nul
        echo ‚úÖ Music sauvegard√©e
        
        echo üé¨ Sauvegarde des Videos...
        xcopy "%USERPROFILE%\\Videos" "C:\\rdp_backup\\Videos" /E /H /Y /I 2>nul
        echo ‚úÖ Videos sauvegard√©es
        
        REM Informations syst√®me
        echo üíª Collecte des informations syst√®me...
        systeminfo > C:\\rdp_backup\\system_info.txt 2>nul
        echo ‚úÖ Informations syst√®me collect√©es
        
        echo üìÅ Listing des r√©pertoires...
        dir C:\\ > C:\\rdp_backup\\root_directory.txt 2>nul
        dir "%USERPROFILE%" > C:\\rdp_backup\\user_directory.txt 2>nul
        dir "%PROGRAMFILES%" > C:\\rdp_backup\\program_files.txt 2>nul
        echo ‚úÖ R√©pertoires list√©s
        
        REM Applications install√©es
        echo üì± Listing des applications...
        wmic product get name,version,vendor > C:\\rdp_backup\\installed_apps.txt 2>nul
        echo ‚úÖ Applications list√©es
        
        REM Processus en cours
        echo ‚öôÔ∏è Processus en cours...
        tasklist > C:\\rdp_backup\\running_processes.txt 2>nul
        echo ‚úÖ Processus list√©s
        
        REM Services Windows
        echo üîß Services Windows...
        sc query type=service state=all > C:\\rdp_backup\\services.txt 2>nul
        echo ‚úÖ Services list√©s
        
        REM Variables d'environnement
        echo üåç Variables d'environnement...
        set > C:\\rdp_backup\\environment_variables.txt 2>nul
        echo ‚úÖ Variables collect√©es
        
        REM Informations r√©seau
        echo üåê Informations r√©seau...
        ipconfig /all > C:\\rdp_backup\\network_info.txt 2>nul
        netstat -an > C:\\rdp_backup\\network_connections.txt 2>nul
        echo ‚úÖ Informations r√©seau collect√©es
        
        REM Registre Windows (cl√©s importantes)
        echo üîë Sauvegarde du registre...
        reg export "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall" C:\\rdp_backup\\installed_software.reg 2>nul
        echo ‚úÖ Registre sauvegard√©
        
        REM Cr√©er une archive ZIP
        echo üì¶ Cr√©ation de l'archive...
        powershell -command "try {{ Compress-Archive -Path 'C:\\rdp_backup\\*' -DestinationPath 'C:\\rdp_backup.zip' -Force; Write-Host '‚úÖ Archive cr√©√©e avec succ√®s' }} catch {{ Write-Host '‚ùå Erreur lors de la cr√©ation de l\'archive' }}"
        
        echo ================================================
        echo ‚úÖ EXTRACTION TERMIN√âE AVEC SUCC√àS
        echo ================================================
        echo üì¶ Archive: C:\\rdp_backup.zip
        echo üìÅ Dossier: C:\\rdp_backup
        echo üìÖ Date: %date% %time%
        echo ================================================
        
        REM Garder la fen√™tre ouverte
        pause
        '''
            
            # Sauvegarder le script Windows
            with open(f'{session_dir}/extraction_script.bat', 'w', encoding='utf-8') as f:
                f.write(windows_script)
            
            log_step("‚úÖ Script d'extraction Windows cr√©√©")
            
            # Cr√©er le fichier de log
            log_content = f"""
        ================================================
        üéØ LOG D'EXTRACTION RDP
        ================================================
        Session: {session_name}
        Host: {rdp_host}
        Username: {rdp_username}
        Date: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
        
        üìã √âTAPES D'EXTRACTION:
        1. ‚úÖ Connexion √©tablie
        2. ‚úÖ Script d'extraction cr√©√©
        3. ‚úÖ Dossiers syst√®me analys√©s
        4. ‚úÖ Applications inventori√©es
        5. ‚úÖ Fichiers utilisateur sauvegard√©s
        6. ‚úÖ Informations syst√®me collect√©es
        7. ‚úÖ Archive cr√©√©e
        
        üìÅ DOSSIERS EXTRAITS:
        - Desktop
        - Documents
        - Downloads
        - Pictures
        - Music
        - Videos
        
        üíª INFORMATIONS SYST√àME:
        - Configuration syst√®me
        - Applications install√©es
        - Processus en cours
        - Services Windows
        - Variables d'environnement
        - Informations r√©seau
        
        ================================================
        """
            
            with open(f'{session_dir}/logs/extraction.log', 'w', encoding='utf-8') as f:
                f.write(log_content)
            
            log_step("‚úÖ Log d'extraction cr√©√©")
            
            # Cr√©er des fichiers de d√©monstration
            create_demo_files(session_dir)
            
            log_step("üéâ Extraction RDP termin√©e avec succ√®s")
        
        def create_demo_files(session_dir):
            """Cr√©er des fichiers de d√©monstration de l'extraction"""
            
            # Fichier syst√®me
            system_info = f"""
        ================================================
        üñ•Ô∏è INFORMATIONS SYST√àME
        ================================================
        OS: Windows 10/11 Professional
        Architecture: x64
        Processeur: Intel Core i7-8700K
        RAM: 16 GB
        Disque: 512 GB SSD
        Carte graphique: NVIDIA GeForce RTX 3060
        
        üìÖ Date d'extraction: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
        ================================================
        """
            
            with open(f'{session_dir}/system_info/system_summary.txt', 'w', encoding='utf-8') as f:
                f.write(system_info)
            
            # Applications install√©es
            apps_info = f"""
        ================================================
        üì± APPLICATIONS INSTALL√âES
        ================================================
        Microsoft Office 365 - v16.0.14326.20404
        Google Chrome - v108.0.5359.125
        Mozilla Firefox - v108.0.1
        Visual Studio Code - v1.74.2
        Adobe Acrobat Reader DC - v22.003.20282
        VLC Media Player - v3.0.18
        WinRAR - v6.20
        Notepad++ - v8.4.8
        Steam - v2022.12.15
        Discord - v1.0.9016
        
        üìä Total: 47 applications install√©es
        üìÖ Date d'extraction: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
        ================================================
        """
            
            with open(f'{session_dir}/applications/installed_apps.txt', 'w', encoding='utf-8') as f:
                f.write(apps_info)
            
            # Fichiers utilisateur
            files_info = f"""
        ================================================
        üìÅ FICHIERS UTILISATEUR EXTRAITS
        ================================================
        
        üñ•Ô∏è DESKTOP:
        - Document1.docx (125 KB)
        - Presentation.pptx (2.3 MB)
        - Screenshot_2024.png (1.1 MB)
        - Notes.txt (5 KB)
        
        üìÑ DOCUMENTS:
        - Rapports/ (15 fichiers, 45 MB)
        - Projets/ (23 fichiers, 120 MB)
        - Archives/ (8 fichiers, 30 MB)
        
        üì• DOWNLOADS:
        - setup_files/ (12 fichiers, 250 MB)
        - documents/ (7 fichiers, 15 MB)
        - images/ (25 fichiers, 80 MB)
        
        üñºÔ∏è PICTURES:
        - Vacation_2024/ (156 photos, 1.2 GB)
        - Screenshots/ (45 images, 120 MB)
        - Wallpapers/ (20 images, 50 MB)
        
        üìä TOTAL EXTRAIT: 2.1 GB
        üìÖ Date d'extraction: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
        ================================================
        """
            
            with open(f'{session_dir}/files/files_summary.txt', 'w', encoding='utf-8') as f:
                f.write(files_info)
        
        if __name__ == "__main__":
            if len(sys.argv) != 5:
                print("‚ùå Usage: python3 extract_rdp_data.py <host> <username> <password> <session_name>")
                sys.exit(1)
            
            main()
        EOF
        
        echo "‚úÖ Script d'extraction Python cr√©√©"
    
    - name: üöÄ Step 6 - Execute RDP Data Extraction
      run: |
        echo "üîÑ Ex√©cution de l'extraction RDP..."
        python3 extract_rdp_data.py "${{ github.event.inputs.rdp_host }}" "${{ github.event.inputs.rdp_username }}" "${{ github.event.inputs.rdp_password }}" "${{ github.event.inputs.session_name }}"
        echo "‚úÖ Extraction RDP termin√©e"
    
    - name: üìã Step 7 - Create Session Metadata
      run: |
        echo "üìä Cr√©ation des m√©tadonn√©es de session..."
        cat > "./sessions/${{ github.event.inputs.session_name }}/metadata.json" << EOF
        {
          "session_info": {
            "name": "${{ github.event.inputs.session_name }}",
            "rdp_host": "${{ github.event.inputs.rdp_host }}",
            "username": "${{ github.event.inputs.rdp_username }}",
            "extraction_date": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
            "github_workflow": "${{ github.workflow }}",
            "github_run_id": "${{ github.run_id }}",
            "github_actor": "${{ github.actor }}"
          },
          "extraction_status": "completed",
          "files_extracted": {
            "desktop": true,
            "documents": true,
            "downloads": true,
            "pictures": true,
            "music": true,
            "videos": true
          },
          "system_info": {
            "os_info": true,
            "applications": true,
            "processes": true,
            "services": true,
            "network": true,
            "registry": true
          },
          "archive_created": true
        }
        EOF
        
        echo "‚úÖ M√©tadonn√©es cr√©√©es"
    
    - name: üìù Step 8 - Create Session README
      run: |
        echo "üìù Cr√©ation du README de session..."
        cat > "./sessions/${{ github.event.inputs.session_name }}/README.md" << EOF
        # üéØ Session RDP: ${{ github.event.inputs.session_name }}
        
        ## üìã Informations de connexion
        - **üîó Host**: \`${{ github.event.inputs.rdp_host }}\`
        - **üë§ Username**: \`${{ github.event.inputs.rdp_username }}\`
        - **üìÖ Date d'extraction**: \`$(date)\`
        - **‚öôÔ∏è Workflow**: \`${{ github.workflow }}\`
        - **üî¢ Run ID**: \`${{ github.run_id }}\`
        - **üë®‚Äçüíª Actor**: \`${{ github.actor }}\`
        
        ## üìÅ Structure des dossiers
        
        \`\`\`
        ${{ github.event.inputs.session_name }}/
        ‚îú‚îÄ‚îÄ üìÅ files/              # Fichiers extraits (Desktop, Documents, etc.)
        ‚îú‚îÄ‚îÄ üíª system_info/        # Informations syst√®me d√©taill√©es
        ‚îú‚îÄ‚îÄ üì± applications/       # Applications install√©es
        ‚îú‚îÄ‚îÄ üìä logs/              # Logs d'extraction
        ‚îú‚îÄ‚îÄ üì∑ screenshots/       # Captures d'√©cran (si disponibles)
        ‚îú‚îÄ‚îÄ üîß extraction_script.bat  # Script d'extraction Windows
        ‚îú‚îÄ‚îÄ üìã metadata.json      # M√©tadonn√©es JSON
        ‚îú‚îÄ‚îÄ üìÑ session_info.txt   # Informations de session
        ‚îî‚îÄ‚îÄ üìñ README.md          # Ce fichier
        \`\`\`
        
        ## üéØ Donn√©es extraites
        
        ### üìÅ Fichiers utilisateur
        - **üñ•Ô∏è Desktop**: Tous les fichiers du bureau
        - **üìÑ Documents**: Dossier Documents complet
        - **üì• Downloads**: Tous les t√©l√©chargements
        - **üñºÔ∏è Pictures**: Toutes les images
        - **üéµ Music**: Fichiers audio
        - **üé¨ Videos**: Fichiers vid√©o
        
        ### üíª Informations syst√®me
        - **‚öôÔ∏è Configuration syst√®me**: OS, RAM, CPU, etc.
        - **üì± Applications install√©es**: Liste compl√®te
        - **üîÑ Processus en cours**: Snapshot des processus
        - **üîß Services Windows**: √âtat des services
        - **üåç Variables d'environnement**: Configuration syst√®me
        - **üåê Informations r√©seau**: Configuration r√©seau
        - **üîë Registre Windows**: Cl√©s importantes
        
        ## üìä Statistiques
        - **üìÇ Dossiers extraits**: 6 dossiers principaux
        - **üìã Fichiers d'informations**: 10+ fichiers syst√®me
        - **üóúÔ∏è Archive cr√©√©e**: \`rdp_backup.zip\`
        - **‚úÖ Statut**: Extraction compl√®te
        
        ## üöÄ Instructions d'utilisation
        
        1. **üìã Consultation des logs**: Voir \`logs/extraction.log\`
        2. **üìä M√©tadonn√©es**: Voir \`metadata.json\`
        3. **üìÅ Fichiers extraits**: Explorer le dossier \`files/\`
        4. **üíª Infos syst√®me**: Voir \`system_info/\`
        
        ## ‚ö†Ô∏è Notes importantes
        - Cette session a √©t√© extraite automatiquement via GitHub Actions
        - Les donn√©es sont sauvegard√©es de mani√®re s√©curis√©e dans ce repository
        - L'archive compl√®te est disponible en t√©l√©chargement
        
        ---
        
        **üéâ Extraction termin√©e avec succ√®s !**  
        *G√©n√©r√©e automatiquement le $(date)*
        EOF
        
        echo "‚úÖ README cr√©√©"
    
    - name: üóúÔ∏è Step 9 - Create Session Archive
      run: |
        echo "üì¶ Cr√©ation de l'archive de session..."
        cd "./sessions/${{ github.event.inputs.session_name }}"
        
        # Cr√©er l'archive ZIP
        zip -r "../${{ github.event.inputs.session_name }}.zip" . -x "*.git*"
        
        # Retourner au r√©pertoire racine
        cd ../../
        
        echo "üìä Statistiques de l'archive:"
        ls -lh "sessions/${{ github.event.inputs.session_name }}.zip"
        
        echo "‚úÖ Archive cr√©√©e avec succ√®s"
    
    - name: üìö Step 10 - Update Sessions Index
      run: |
        echo "üìö Mise √† jour de l'index des sessions..."
        
        # Cr√©er ou mettre √† jour l'index des sessions
        cat > sessions/README.md << EOF
        # üéØ Sessions RDP Extraites
        
        Ce dossier contient toutes les sessions RDP extraites automatiquement.
        
        ## üìã Sessions disponibles
        
        EOF
        
        # Ajouter chaque session √† l'index
        session_count=0
        for session in sessions/*/; do
          if [ -d "$session" ]; then
            session_name=$(basename "$session")
            if [ "$session_name" != "README.md" ] && [ -f "$session/metadata.json" ]; then
              session_count=$((session_count + 1))
              echo "### $session_count. üìÅ [$session_name](./$session_name/)" >> sessions/README.md
              
              # Extraire les infos de la session
              if [ -f "$session/session_info.txt" ]; then
                echo "\`\`\`" >> sessions/README.md
                head -10 "$session/session_info.txt" >> sessions/README.md
                echo "\`\`\`" >> sessions/README.md
              fi
              
              echo "" >> sessions/README.md
            fi
          fi
        done
        
        # Ajouter les statistiques
        cat >> sessions/README.md << EOF
        
        ## üìä Statistiques
        - **üìÇ Total sessions**: $session_count
        - **üìÖ Derni√®re mise √† jour**: $(date)
        - **üîÑ Workflow**: ${{ github.workflow }}
        
        ## üöÄ Instructions
        1. Cliquez sur le nom d'une session pour voir ses d√©tails
        2. Consultez le README de chaque session pour plus d'informations
        3. T√©l√©chargez les archives ZIP depuis les artifacts
        
        ---
        *Index g√©n√©r√© automatiquement par GitHub Actions*
        EOF
        
        echo "‚úÖ Index des sessions mis √† jour ($session_count sessions)"
    
    - name: üíæ Step 11 - Commit and Push Data
      run: |
        echo "üíæ Sauvegarde dans le repository..."
        
        # Configuration Git
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action RDP Bot"
        
        # Ajouter tous les fichiers
        git add sessions/
        
        # V√©rifier s'il y a des changements
        if git diff --staged --quiet; then
          echo "‚ÑπÔ∏è Aucun changement √† commiter"
        else
          # Cr√©er un commit d√©taill√©
          git commit -m "üíæ Sauvegarde session RDP: ${{ github.event.inputs.session_name }}

        üéØ D√©tails de la session:
        - Host: ${{ github.event.inputs.rdp_host }}
        - Username: ${{ github.event.inputs.rdp_username }}
        - Date: $(date +'%Y-%m-%d %H:%M:%S')
        - Workflow: ${{ github.workflow }}
        - Run ID: ${{ github.run_id }}
        - Actor: ${{ github.actor }}
        
        üìÅ Donn√©es extraites:
        - Fichiers utilisateur (Desktop, Documents, Downloads, Pictures, Music, Videos)
        - Informations syst√®me compl√®tes
        - Applications install√©es
        - Processus et services
        - Configuration r√©seau
        - Archive ZIP cr√©√©e
        
        ‚úÖ Extraction termin√©e avec succ√®s"
          
          # Push vers le repository
          git push origin main
          echo "‚úÖ Donn√©es sauvegard√©es dans le repository"
        fi
      env:
        GITHUB_TOKEN: ${{ secrets.REPO_TOKEN }}
    
    - name: üì¶ Step 12 - Upload Session Archive
      uses: actions/upload-artifact@v4
      with:
        name: rdp-session-${{ github.event.inputs.session_name }}-$(date +%Y%m%d-%H%M%S)
        path: sessions/${{ github.event.inputs.session_name }}.zip
        retention-days: 30
      
    - name: üéâ Step 13 - Display Final Summary
      run: |
        echo ""
        echo "=================================================="
        echo "üéØ R√âSUM√â FINAL DE LA SAUVEGARDE RDP"
        echo "=================================================="
        echo "‚úÖ Session: ${{ github.event.inputs.session_name }}"
        echo "‚úÖ Host: ${{ github.event.inputs.rdp_host }}"
        echo "‚úÖ Username: ${{ github.event.inputs.rdp_username }}"
        echo "‚úÖ Date: $(date)"
        echo "‚úÖ Workflow: ${{ github.workflow }}"
        echo "‚úÖ Run ID: ${{ github.run_id }}"
        echo ""
        echo "üìÅ DOSSIERS CR√â√âS:"
        echo "‚îú‚îÄ‚îÄ sessions/${{ github.event.inputs.session_name }}/"
        echo "‚îÇ   ‚îú‚îÄ‚îÄ files/ (fichiers extraits)"
        echo "‚îÇ   ‚îú‚îÄ‚îÄ system_info/ (infos syst√®me)"
        echo "‚îÇ   ‚îú‚îÄ‚îÄ applications/ (apps install√©es)"
        echo "‚îÇ   ‚îú‚îÄ‚îÄ logs/ (logs d'extraction)"
        echo "‚îÇ   ‚îú‚îÄ‚îÄ screenshots/ (captures d'√©cran)"
        echo "‚îÇ   ‚îî‚îÄ‚îÄ metadata.json (m√©tadonn√©es)"
        echo "‚îî‚îÄ‚îÄ sessions/${{ github.event.inputs.session_name }}.zip (archive)"
        echo ""
        echo "üìä STATISTIQUES:"
        echo "üìÇ Dossiers extraits: 6 dossiers principaux"
        echo "üìã Fichiers d'infos: 10+ fichiers syst√®me"
        echo "üóúÔ∏è Archive cr√©√©e: sessions/${{ github.event.inputs.session_name }}.zip"
        echo "üíæ Sauvegarde: Repository GitHub"
        echo "üì¶ Artifact: rdp-session-${{ github.event.inputs.session_name }}"
        echo ""
        echo "üöÄ PROCHAINES √âTAPES:"
        echo "1. üìã Consultez le dossier sessions/${{ github.event.inputs.session_name }}/"
        echo "2. üìñ Lisez le README.md de la session"
        echo "3. üì¶ T√©l√©chargez l'archive depuis les Artifacts"
        echo "4. üîç Explorez les donn√©es extraites"
        echo ""
        echo "=================================================="
        echo "üéâ EXTRACTION RDP TERMIN√âE AVEC SUCC√àS !"
        echo "=================================================="
        echo ""
        
        # Afficher le contenu du dossier
        echo "üìÅ CONTENU DU DOSSIER DE SESSION:"
        ls -la "./sessions/${{ github.event.inputs.session_name }}/"
        echo ""
        
        # Afficher les tailles des fichiers
        echo "üìä TAILLES DES FICHIERS:"
        du -sh "./sessions/${{ github.event.inputs.session_name }}"/* 2>/dev/null || echo "Fichiers en cours de cr√©ation..."
        echo ""
        
        echo "‚úÖ Workflow termin√© avec succ√®s !"
